<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Painel do Administrador</title>
        <link rel="stylesheet" href="css/cabeçalho-rodape.css">
        <link rel="stylesheet" href="css/login-cadastro.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.css"/>
        <script src="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.js"></script>
        <script src="../../js/notify.js"></script>
    </head>
<body>
    <header>
        <a id="topimg" href="/" aria-label="logo"><img src="imagem/LogoMuvall.png" alt="Logo da empresa MUVALL"
                rel="prev"></a>
    
        <nav>
            <div id="menu-container">
    
                <div></div>
                <div></div>
                <div></div>
    
    
                <ul id="menu-items" class="NaoPropagar">
                    <img src="imagem/delete.png" alt="Fechar" id="close">
                    <li class="NaoPropagar"><a href="perfilUsuario" aria-label="Perfil" rel="next">Minha conta</a></li>
                    <li class="NaoPropagar"><a href="anunciar">Anuncie</a></li>
                    <li class="NaoPropagar"><a href="faleConosco" aria-label="Fale conosco" rel="next">Fale Conosco</a></li>
                    <li class="NaoPropagar"><a href="login">Entre</a></li>
                    <li class="NaoPropagar"><a href="cadastro">Cadastre-se</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>

        <% 

        let arquivo = {"imagem":"imagem/perfil.png"}
     
        if(valores.img_perfil != null){
            arquivo.imagem = valores.img_perfil
        }

    let msgErro = {"nome_usuario":"", "email_usuario":"" }
    let avisoErro = {"nome_usuario":"", "email_usuario":""}
    if(listaErros){
        listaErros.errors.forEach(function(itemErro){
            if(itemErro.path == "nome"){
                avisoErro.nome = "erro";
                msgErro.nome += " "+itemErro.msg
            %>
            <script>
                notify("Erro no preenchimento","Verifique o campo nome<br><%= itemErro.msg%>", "error", "center")                        
            </script>
            <%
        }
        if(itemErro.path == "email"){
            avisoErro.email = "erro";
            msgErro.email = itemErro.msg
            %>
            <script>
                notify("Erro no preenchimento","Verifique o campo e-mail", "error", "center")                        
            </script>
            <%
        }
        })
    }
    
    if (dadosNotificacao) { 

        %>
        <script>
                notify("<%= dadosNotificacao.titulo%>","<%= dadosNotificacao.mensagem%>", "<%= dadosNotificacao.tipo%>", "center")
                
                if("<%= dadosNotificacao.tipo %>" == "success"){
                    setTimeout(function(){
                        window.location="/"
                    }, 3000)
                }                        
        </script>
    <% } %>

    <h1>Painel Administrativo</h1> 
    <label for="editSlides" id="label-edSl">Editar Slides</label>

    <section class="slider-edit" name="editSlides">

        <div class="img-s-edicao">
            <img src="imagens/Slide_3.png" alt="Imagem de edição slides">
            <img src="imagens/Slide_2.png" alt="Imagem de edição slides">
            <img src="imagens/Slide_2.png" alt="Imagem de edição slides">
        </div>

        <br>

        <div class="slider-options">
            <div class="btns-n-p">
                <button id="regredir_slide" id="scroll-up"><span class="material-symbols-outlined"> chevron_left </span></button>
                <button id="avançar_slide"><span class="material-symbols-outlined"> chevron_right </span></button>
            </div>

            <div class="load-slide-img">
                <input type="file">
            </div>

            <div class="s-and-c">
                <button id="save">Salvar</button>
                <button id="cancel">Cancelar</button>
            </div>
        </div>
    </section>

    <section class="membros_anuncios">
        <label for="members_posts" id="label-mb">Usuários</label>
        <div class="members_posts-div" name="members_posts">
                <span><span class="material-symbols-outlined">group</span><%= totalUsuarios %> Usuários</span>
                <div class="linha-vertical"></div>
                <span><span class="material-symbols-outlined">perm_media</span>67 Posts</span>
        </div>

    </section>

    <div class="search">
        <input type="text" id="pesquisa" placeholder="Pesquisar">
        <span class="material-symbols-outlined">filter_alt </span>
    </div>

    <section class="usuarios">
        <table>
            <thead>
                <tr>
                    <th><span class="material-symbols-outlined">badge</span>Nome</th>
                    <th><span class="material-symbols-outlined">supervised_user_circle</span>Tipo</th>
                    <th><span class="material-symbols-outlined">progress_activity</span>Status usuário</th>
                </tr>
            </thead>
            <tbody>
                <% usuarios.forEach(function(usuario, index) { %>
                    <tr>
                        <td>
                            <span class="material-symbols-outlined" title="Reativar Usuário" onclick="abrirPopUpR(<%= usuario.id_usuario %>)" id="reatv-user">check_circle</span>
                            <img src="<%= usuario.img_perfil_pasta ? usuario.img_perfil_pasta : 'imagens/img-perfil.png' %>" alt="Imagem <%= index + 1 %>"><%= usuario.nome %>
                            <span class="material-symbols-outlined" onclick="abrirPopUp(<%= usuario.id_usuario %>)" title="Desativar Usuário">delete</span>
                            <span class="material-symbols-outlined" title="Editar Usuário">edit</span>
                            
                        </td>
                        <td>
                            <% if (usuario.tipo_usuario === 1) { %>
                                Comum
                            <% } else if (usuario.tipo_usuario === 2) { %>
                                Administrador
                            <% } else if (usuario.tipo_usuario === 3) { %>
                                Administrador Tipo 2
                            <% } %>
                        </td>
                        <td><%= usuario.status_usuario %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </section>

    <br>

<div class="pop-up">
    <div class="modal">
        <hr />
            <h2>Você tem certeza que deseja continuar?</h2>
            <span>Ao continuar o usuario selecionado será desativado!</span>
        <hr />
        <div class="btns">
            <button class="btn-sim" onclick="desativarUsuario()">Sim</button>
            <button class="btn-nao" onclick="closePopUp()">Não</button>
        </div>
    </div>
</div>

<div class="pop-up" id="reactivate-popup">
    <div class="modal">
        <hr />
            <h2>Você tem certeza que deseja continuar?</h2>
            <span>Ao continuar o usuario selecionado será reativado!</span>
        <hr />
        <div class="btns">
            <button class="btn-sim" onclick="reativarUsuario()">Sim</button>
            <button class="btn-nao" onclick="closePopUpR()">Não</button>
        </div>
    </div>
</div>
    </main>


    <footer>
        <img src="imagem/LogoMuvall.png" alt="Logo MUVall">
        <a href="faleConosco">Fale conosco</a>
        <div id="cadastro-rodape">
            <h2>Cadastro</h2>
            <ul>
                <li><a href="cadastro" rel="next">Usuário</a></li>
                <li><a href="cadastro-anunciante" rel="next">Anunciante</a></li>
            </ul>
        </div>
        <div id="redesSociais">
            <h2>Redes sociais</h2>
            <a href="https://instagram.com"><img src="img/instagram.png" alt="Logo Instagram" target="_blank" rel="external"></a>
            <a href="https://instagram.com"><img src="img/linkedin.png" alt="Logo Facebook" target="_blank" rel="external"></a>
        </div>
    </footer>
    <script src="js/script.js"></script>
</body>
</html>