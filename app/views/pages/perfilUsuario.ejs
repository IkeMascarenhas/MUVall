<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perfil</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="css/cabeçalho-rodape.css" />
    <link rel="stylesheet" href="css/perfil.css" />
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/login-cadastro.css">
    <script src="script/script.js" defer></script>   
    <script src="script/user-preview.js" defer></script> 
    <!-- <script src="script/verMais.js" defer></script> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/simple-notify@0.5.5/dist/simple-notify.min.js"></script>
    <script src="../../js/notify.js"></script>
    
  </head>
  <body>
    <header>
      <a id="topimg" href="/" aria-label="logo"
        ><img src="imagem/LogoMuvall.png" alt="Logo da empresa MUVALL" rel="prev"
      /></a>

      <nav>
        <div id="menu-container">
          <div></div>
          <div></div>
          <div></div>

          <ul id="menu-items" class="NaoPropagar">
            <img src="imagem/delete.png" alt="Fechar" id="close" />
            <li class="NaoPropagar">
              <a href="perfilUsuário" aria-label="Perfil" rel="next">Minha conta</a>
            </li>
            <li class="NaoPropagar"><a href="anunciar">Anuncie</a></li>
            <li class="NaoPropagar">
              <a href="faleConosco" aria-label="Fale conosco" rel="next"
                >Fale Conosco</a
              >
            </li>
            <li class="NaoPropagar"><a href="login">Entre</a></li>
            <li class="NaoPropagar"><a href="cadastro">Cadastre-se</a></li>
          </ul>
        </div>
      </nav>
    </header>

    <%

    let arquivo = {"imagem":"imagem/perfil.png"}
 
    if(valores.img_perfil != null){
        arquivo.imagem = valores.img_perfil
    }

    let msgErro = {"nome_usu":"", "email_usu":""}
    let avisoErro = {"nome_usu":"", "email_usu":""}
    if(listaErros){
        listaErros.errors.forEach(function(itemErro){
            if(itemErro.path == "nome_usu"){
                avisoErro.nome_usu = "erro";
                msgErro.nome_usu += " "+itemErro.msg
                %>
                <script>
                    notify("Erro no preenchimento","Verifique o campo nome <br><%= itemErro.msg%>", "error", "center")                        
                </script>
                <%
              }
            if(itemErro.path == "email_usu"){
                avisoErro.email_usu = "erro";
                msgErro.email_usu = itemErro.msg
                %>
                <script>
                    notify("Erro no preenchimento","Verifique o campo e-mail", "error", "center")                        
                </script>
                <%
            }
        })
    }
    
    if (dadosNotificacao) { 

        %>
        <script>
                notify("<%= dadosNotificacao.titulo%>","<%= dadosNotificacao.mensagem%>", "<%= dadosNotificacao.tipo%>", "center")
                
                if("<%= dadosNotificacao.tipo %>" == "success"){
                    setTimeout(function(){
                        window.location="/"
                    }, 3000)
                }                        
        </script>
    <% } %>

    
    <section class="empresa">
        <div id="logo-nome">
          <label for="img-perfil" id="user"><img src="<%= arquivo.imagem %>" alt="Logo da Empresa"/></label>
          <input type="file" name="img-perfil" id="img-perfil">
          <h1><%= valores.nome_usu%> </h1>
          <div class="stars-box" style="margin-bottom: 2.5vh;">
            <i class="fa-solid fa-star"></i>
            <i class="fa-solid fa-star"></i>
            <i class="fa-solid fa-star"></i>
            <i class="fa-solid fa-star"></i>
            <i class="fa-solid fa-star"></i>
        </div>
        </div>
      </section>
      <main>
        <section class="administrar">
          <a href="">
            <img src="imagem/wall-clock.png" alt="pendentes">
            <p>Contratações pendentes</p>
          </a>
          <a href="#editar">
            <img src="imagem/edit.png" alt="Editar Perfil">
            <p>Editar Perfil</p>
          </a>
          <a href="avaliacoes">
            <img src="imagem/star.png" alt="Ver Avaliações">
            <p>Avaliações</p>
          </a>
          <a href="anunciar">
            <img src="imagem/plus.png" alt="Anunciar">
            <p>Anunciar</p>
          </a>
        </section>
          <button class="btn">Excluir conta</button>
      </main>

      <form action="cadastro" method="post" style="width: 80vw; margin: auto;" id="#editar">
        <p>
          <input type="email" name="email_usu" placeholder="E-Mail:" id="email_usu" value="<%= valores.email_usu %>" class="<%= avisoErro.email_usu %>" required maxlength="100">
          <span> <%= msgErro.email_usu %> </span> <b>*</b>
        </p>
        <p>
          <input type="text" name="nome_usu" placeholder="Nome:" id="nome" value="<%= valores.nome_usu %>" class="<%= avisoErro.nome_usu %>" required maxlength="100" minlength="3">
          <span> <%= msgErro.nome_usu %> </span> <b>*</b>
        </p>
        <p>
          <input type="password" name="senha_usu" placeholder="Senha:" id="senha_usu" maxlength="30" minlength="8">
          <span class="aviso">Não preencha este campo para manter a senha atual</span>
        </p>
        <button type="submit" id="cadastrar-bttn">Confirmar</button>
    </form>
    <footer>
        <img src="imagem/LogoMuvall.png" alt="Logo MUVall" />
        <a href="faleConosco">Fale conosco</a>
        <div id="cadastro-rodape">
          <h2>Cadastro</h2>
          <ul>
            <li><a href="cadastro" rel="next">Usuário</a></li>
            <li><a href="cadastro-anunciante" rel="next">Anunciante</a></li>
          </ul>
        </div>
        <div id="redesSociais">
          <h2>Redes sociais</h2>
          <a href="https://instagram.com"
            ><img
              src="imagem/instagram.png"
              alt="Logo Instagram"
              target="_blank"
              rel="external"
          /></a>
          <a href="https://instagram.com"
            ><img
              src="imagem/linkedin.png"
              alt="Logo Facebook"
              target="_blank"
              rel="external"
          /></a>
        </div>
      </footer>
  
    </body>
  </html>
  